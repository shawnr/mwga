"use strict";angular.module("mwgaApp",["ngAnimate","ngAria","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch","ngStorage"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).otherwise({redirectTo:"/"})}]),angular.module("mwgaApp").controller("MainCtrl",["$scope","current","forecast","citycheck","$localStorage","invalidCity","weatherText",function(a,b,c,d,e,f,g){a.showCurrent=!1,a.showForecast=!1,a.showInvalidCity=!1,a.showNoQuery=!1,a.dataLoading=!1,a.showSearch=!0,a.invalidMessage="",a.weatherText=g,a.currHour=(new Date).getHours(),a.currHour>5&&a.currHour<17?a.currDayTime="day":a.currDayTime="night";var h=Date.now();if(e.cacheTimestamp){var i=new Date(e.cacheTimestamp),j=new Date(h),k=Math.round((j-i)/6e4);k>10?(console.log("Cache is expired. Refreshing."),a.current=b.query(),a.current.$promise.then(function(a){e.currentCache=a}),a.forecast=c.query(),a.forecast.$promise.then(function(a){e.forecastCache=a}),e.cacheTimestamp=h):(console.log("Cache is still fresh. Loading from local storage."),a.current=e.currentCache,a.forecast=e.forecastCache)}else console.log("Cache does not exist. Creating."),a.current=b.query(),a.current.$promise.then(function(a){e.currentCache=a}),a.forecast=c.query(),a.forecast.$promise.then(function(a){e.forecastCache=a}),e.cacheTimestamp=h;a.openCurrent=function(){a.dataLoading=!0,a.city?(a.showNoQuery=!1,a.cityCheck=d.query({location:a.city}),a.cityCheck.$promise.then(function(b){"US"===b.sys.country?(console.log("City is in the USA."),a.showSearch=!1,a.showForecast=!1,a.showCurrent=!0,a.showInvalidCity=!1):(a.showInvalidCity=!0,a.invalidMessage=f.getMessage(),console.log("City is invalid. Not in the USA. "+a.invalidMessage))})):a.showNoQuery=!0},a.openForecast=function(){a.showSearch=!1,a.showCurrent=!1,a.showForecast=!0,a.showInvalidCity=!1},a.openSearch=function(){a.showSearch=!0,a.showCurrent=!1,a.showForecast=!1,a.showInvalidCity=!1}}]),angular.module("mwgaApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("mwgaApp").factory("current",["$resource",function(a){return a("http://api.openweathermap.org/data/2.5/weather?id=:id&units=imperial&APPID=d9947bfbe4d5f42fa39c0d5e08ff915f",{},{query:{method:"GET",params:{id:"524901"},isArray:!1}})}]),angular.module("mwgaApp").factory("forecast",["$resource",function(a){return a("http://api.openweathermap.org/data/2.5/forecast/daily?id=:cityID&cnt=16&units=imperial&APPID=d9947bfbe4d5f42fa39c0d5e08ff915f",{},{query:{method:"GET",params:{cityID:"524901"},isArray:!1}})}]),angular.module("mwgaApp").factory("citycheck",["$resource",function(a){return a("http://api.openweathermap.org/data/2.5/weather?q=:location&units=imperial&APPID=d9947bfbe4d5f42fa39c0d5e08ff915f",{},{query:{method:"GET",params:{location:"Washington, DC"},isArray:!1}})}]),angular.module("mwgaApp").factory("invalidCity",function(){var a=["The weather there will never be great. Unless I move there and they elect me President.","They might have weather there. They might have bad weather. They might have good weather. Who knows?","The weather there is bad, bad, bad. Bad, dark clouds. Bad rain. Thunder. It could be good, but it isn't. We know that.","They could have good weather. But they don't send us their best weather. They send us cold, clouds, rain. Probably.","The weather there is not great. But it's better than the weather here sometimes! But we'll make the weather here so great that you will get sick of sunny days and moderate temps!","The weather there is great. I wish we could have such good weather. But that's how things are now. Sad.","They have the worst weather. I can't even imagine it. How bad could it be? Really bad.","They are not sending us their best weather. They send us clouds. They send us rain. Rain is good sometimes, but not usually."];return{getMessage:function(){return a[Math.floor(Math.random()*a.length)]}}}),angular.module("mwgaApp").factory("weatherText",function(){var a=function(a){var b="The weather there is going to be very unknown. Unknowable even. Who really knows? Nobody. But we're gonna figure it out.";return b};return{getWeatherDescription:function(b){return a(b)}}}),angular.module("mwgaApp").run(["$templateCache",function(a){a.put("views/about.html","<p>This is the about view.</p>"),a.put("views/main.html",'<div class="search" ng-show="showSearch"> <p class="form"><input type="text" ng-model="city" placeholder="Enter city name."> <button ng-click="openCurrent()" class="btn btn-large btn-primary">Get REAL Weather!</button></p> <p>(American cities only, please.)</p> </div> <div class="current" ng-show="showCurrent"> <h2>The REAL Weather for: {{city | uppercase}}</h2> <dl> <dt>Currently</dt> <dd><i class="wi wi-owm-{{currDayTime}}-{{current.weather[0].id}}"></i></dd> <dd>{{current.weather[0].main}}</dd> <dd>{{weatherText.getWeatherDescription(current.weather[0].id)}}</dd> <dt>Temperature</dt> <dd>{{current.main.temp}}</dd> <dt>Wind</dt> <dd>{{current.wind.speed}} mph at {{current.wind.deg}} degrees</dd> <dt>Clouds</dt> <dd>{{current.clouds.all}}%</dd> </dl> <p><button ng-click="openForecast()" class="btn btn-block btn-primary">View Full REAL Forecast</button></p> </div> <div class="forecast" ng-show="showForecast"> <h2>The REAL Forecast for: {{city | uppercase}}</h2> <dl ng-repeat="prediction in forecast.list" class="weather-forecast"> <dt>Forecast for {{prediction.dt*1000 | date:\'MMM dd, yyyy\'}}</dt> <dd><i class="wi wi-owm-{{currDayTime}}-{{prediction.weather[0].id}}"></i></dd> <dd>{{prediction.weather[0].main}}</dd> <dd>{{prediction.weather[0].description}}</dd> <dt>Temperature</dt> <dd>Min: {{prediction.temp.min}} &deg;F Max: {{prediction.temp.max}} &deg;F</dd> </dl> <p><button ng-click="openForecast()" class="btn btn-block btn-primary">View Current REAL Weather</button></p> </div> <div class="invalid-city" ng-show="showInvalidCity"> <h2>{{ city | uppercase }} is Not in the USA!</h2> <p class="lead">{{ invalidMessage }}</p> <p>Please search for another city.</p> </div> <div class="no-query" ng-show="showNoQuery"> <h2>Missing City Name. Sad!</h2> <p class="lead">You must enter the name of an American city to find weather information.</p> </div> <p ng-show="!showSearch"><button class="btn btn-block btn-primary" ng-click="openSearch()">Get REAL Weather Information for Another City</button></p>')}]);